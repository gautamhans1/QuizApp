language: android
sudo: required
jdk: oraclejdk8
before_cache: 
  - rm -f $HOME/.gradle/caches/modules-2/modules-2.lock 
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache: "-$HOME/.gradle/caches -$HOME/.gradle/wrapper"
env:
  global:
  - ANDROID_API=28
  - EMULATOR_API=28
  - ANDROID_BUILD_TOOLS=28.0.2
  - ADB_INSTALL_TIMEOUT=5
  - secure: cmN7NOE1a2u6shszWlnTM929mqJvLEYpflTAjbySn9rZfGNpeIw6GBHdHbHu8d/UhclyipPw6kp2YAMT0g7IpdnWHMvp7NdXAxOPdtaND3ZHzvHtQzvUzxmU65nEckwM+atnho9STeVegmSSU8j9jsN/cE/AoZ/4+mEC5ePTFJqtnOHL9E8rmVdXfB2U4ytvwXODU8Ncaokw707j33U4O+T3J1Mnx/2EJ3Ny93oAWZIyfqSevzvG5z6YO9HE7b+4EKKWYm5KDEXGEwmL3dgaEQZAJGXwvgZaJl229HLBqPndyyJVV4j7eNTsZp290rEHzf8kzAC3qd7hmMCgZDPRe0B+OnwZJ35b5y8hAKIGVPuaygXVFfKF85opzLJCcCKOB6ngcj02Gj0IBFpWTYi03n4NC6BSdJP4RUMTtYI7O95wm6F+L7JO7+/2oZWqCXsq+o+Q2R9ZK2yB8voxvbK/H8aPai2xCXDi1hvM2lINRLuGVJY/EPSn4TLbRSoJjdZy15Fpp1TLyajpQnQeVu9R7ECUyv0BGic+VZkWyDj2meSl1dlm+Mxam979fbBVxPiRAi0Gvy22SRCAh77QTnhoe6fxFmBfGGfMYXLIv0j4ilYf8BwABV0KEbssC+iGfQQtM4rUqRSsKl3rKBGb1mCo8ea13n+bNYBihoE8Gp+N3pk=
  - secure: oRepP/4VUW8i44jf5VeamkGdXHSUUdj7oVRfDeqGLyf9D16k/F0UqCm+zzAK6Mo6XuZsabsiuaWrIRgRMK366DUiNjWtqOe/PdOrHZIvuozQbCtieiRgzMCjF3e6mvNye3t4uka08evYM5+KyMc4FH3px3TWWNJYirvRcwX7CMoA6tJpVXnVFJMku75qtMtk4t7hVYbtKWyXIjplf6Mpe8XKik0j8RpIrA2VQuRmC6nJ7pp1VKHGMTLzWN5oVpQNi0pbzniWnjdieW10o7QUo6LfJrHr4cuI3D0MCFI/9vhG9A+vd7fv6FKIRtJMmOxSflLfqRAtLM1sa8JhCHIZwz1omTO9zI2IJjDSGfS4FGbAWaa1Nq5weN/BvoV4ypvfqp2P21autirNHUmWibp3WAsYdl48mU+t0jfG/d2GPST4zHs0/pjQfQgaKQs/qdHTvoGQpPjJSQO28yiFtD/6C5z0i3z9uMPhuB7OjSICWY/XIAuVooVhNx88qeC+ZV4tQD7mEmlMPesrS7cAJpRtcPH6kxQ4vSFYxOPgOah83HEyrrf0ZlBbTPW7AYC6+bVJ1OTVW7O0QB2O46o1PPXppBUkqEaS53KLvdOMnWfmxGnMaF61fo9i5oJPJNAjNOCHC2SugC5HJDVVelThyU4groJpqIfFwNWLuQ+m2kqmFNE=
  - secure: TKw8L1ozAOpQ7bTpSyvk5IUdNnOkrXxq3ptzK+hM+EjxtYTEcwlvPPbxgA79Fi2p5drn+yvf1y/Pqo03mkL847w7OyevxnfhpzrtfLVdXv8XbMLRqVkU4buxQoybz1fEX1T3/JLJ3Axu8p6aHy3HiCijR/zMwgCH6GzN6FbQ35/q6CKhmFtJdni6ujruIyTa1Y3wGXUPAilQHsAdOJNMg8uSB/pv9e/bVI9ZWLUQNJcItIIujE5y2trJ1NxkPXYcoK3xmC9M1YhuSCKpbitpib+N/VXxI2o50Cfk5rBlp72FtXf2AXS3/AcRbVGQAyDVH6qvoJsefMqyCPmahlKIsQZXGVxeyM7FSWSidBw7ALAChBM3w7ipGZ7LYGAbr1latsSfNVm8E3Geiqr82yvUqXypBoT1BSitqaGhIgyblzqBKDwzrDl8/8gQFdzh9/4vu0jYgn+PouRGdEZ6rkMkTselZUBsxcLNbXybE6LFWUdcD1KvZiMFiab7uMrtgt4BpqyZOGVFfiyBK0e7v0H3s1uHqdskuibgFhWJZ0asiohv8DDLonnh1jD0YrXQnzXurLT9kexetl5TO4Cx3u4VYc+h+udanY/q06WSThpbTVLllkLKgCBvWujurMlc96DMLmLMr+uuvgSfggCUxHh406xKssTvSJJrFmCAWPGAk4s=
android:
  components:
  - tools
  - tools
  - build-tools-$ANDROID_BUILD_TOOLS
  - android-$ANDROID_API
  - android-$EMULATOR_API
  - extra-google-m2repository
  - extra-android-m2repository
  - addon-google_apis-google-19
  # - sys-img-armeabi-v7a-google_apis-$ANDROID_API
  # - sys-img-armeabi-v7a-addon-google_apis-google-$ANDROID_API_LEVEL
  # - sys-img-armeabi-v7a-addon-google_apis-google-$EMULATOR_API_LEVEL
  licenses:
  - android-sdk-preview-license-.+
  - android-sdk-license-.+
  - google-gdk-license-.+
before_install:
- openssl aes-256-cbc -K $encrypted_14a98f9a8c09_key -iv $encrypted_14a98f9a8c09_iv
  -in keystore.jks.enc -out keystore.jks -d
- mkdir "$ANDROID_HOME/licenses" || true
- echo -e "\n8933bad161af4178b1185d1a37fbf41ea5269c55" > "$ANDROID_HOME/licenses/android-sdk-license"
- echo -e "\n84831b9409646a918e30573bab4c9c91346d8abd" > "$ANDROID_HOME/licenses/android-sdk-preview-license"
- yes | sdkmanager "platforms;android-27"
- pwd
- ls -la
- apt-get install dos2unix -y
- dos2unix gradlew
- chmod +x gradlew
- "./gradlew dependencies || true"
# before_script:
# - echo no | android create avd --force -n test -t android-28 --abi google_apis/armeabi-v7a
# - emulator -avd test -no-skin -no-audio -no-window &
# - android-wait-for-emulator
# - adb shell input keyevent 82 &
script:
- "./gradlew clean build connectedCheck -PdisablePreDex --stacktrace"
before_deploy:
- cp $TRAVIS_BUILD_DIR/.keystore $HOME
- cd app/build/outputs/apk/release/
- jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore $HOME/keystore.jks
  -storepass $storepass -keypass $keypass QuizApp-release-unsigned.apk gautam
- jarsigner -verify QuizApp-release-unsigned.apk
- "${ANDROID_HOME}/build-tools/28.0.2/zipalign -v 4 QuizApp-release-unsigned.apk QuizApp.apk"
deploy:
  provider: releases
  api_key:
    secure: YiH3Dej10HeRzFlujcmHFSCUrFaKqMxW2WZXhAUHG9KMsVYumOn6mCgVTXa0o9qkEZhVLZlrYrTRgvCI1nFf7M27kZW1/MyHD/APnYYMxHt6qZGnMn/AheU4Gsr6/jtUhKvyEMtreG6j/hCiWk79Qq58d54NWevP9wiWbO+MkjDs2SqD+KeDlVa5V0rDMdZRHqHMYh73+dviySBeEnNJlC4i0HYKB3Gixkc0geNyNK4X44aBK9tld3Zan8Ekf/D4GcVVNXtVI94FFEbRatXG5lc1OLr6rKMHGFHmawcPMDWctMOoZJWQ1P3FnP7ASbujqbo/Tp7GQmUW45GlL+vEJLdAR3VVMvOGEEpAzHanR8rKqEajmzQavpq0s9oAV3cq43wBkn44Mpc1z0+wrGyXv+0lOm/h7Pq+VKhSTYp2tOZLbHU7sFlxnL/V06x+XDvlY1IldBOXTTJ78RrglHoN3I3MvmUst3KWk/hiVoI7k/bsecDp7HAAQYQP0Ku6uQ+BlPoFpm7DLUMrvxIoVaNpttAYTIstRVxQQtXbHnK0MIsZrAB9VP4IkImsPZ5DMflVE6b+DK07kz3xTRTxwfaqax41ycFtqHaXNoypL8zqJhJVor2Xt9GD4Oq64eOeLS67YWIJTDcdV1xwGlG/rXF7JuowatQXMtNxHo7Ji17lS7M=
  file: QuizApp.apk
  skip_cleanup: true
  on:
    repo: gautamhans1/QuizApp
after_success:
- sh set_tags.sh
